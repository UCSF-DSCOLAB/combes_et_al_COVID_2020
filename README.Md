# Global Absence and Targeting of Protective Immune States in Severe COVID-19

This repository contains all code used to process and illustrate figured used in the 2020 Nature Publication.

The repository is organized as
```
base
  |- auxiliary_files (Various Files used during the analysis)
  |
  |- auxiliary_scripts (Various Scripts sourced during the analysis)
  |
  |- *.R (R scripts)
  |
  +- README.Md (This file)
```

All code has been thoroughly documented to describe major code functions. 

Certain paths to files and scripts *may* be pointing to the files within our system, but the files/scripts themselves will be within the appropriate auxiliary_* folder within this repository.

# Analysis pipeline

1. `process_single_library.R` --> processes each library to a identify major cell types
2. `create_merged_colossal_paper_final.R` -> Merged files generated by `process_single_library.R` to generate a Harmony batch-corrected Seurat object
3. `annotate_and_split_merged_colossal_paper_final.R` -> Annotated coarse clusters into one of 5 major types (`Neutrophil`, `Mono_MACs_DC`, `B_Plasma`, `Platelet` , and `TNK`), and create separate Harmony batch-corrected objects for each. This process was rerun once the individual objects were processed in the next step and noisy cells were identified for removal.
4. `process_COMPARTMENT_final.R` -> Will process a single compartment object to identify subtypes and ISG scores. Cells identified as junk are passed back to step 3 before producing a final, cleaned compartment-level object.

# Citing our work

TBD

# Contact Info

Arjun Rao (GH: @arkal, email: ArjunArkal[dot]Rao[at]ucsf[dot]edu)
Alexis Combes (email: Alexis[dot]Combes[at]ucsf[dot]edu)
Matthew Krummel (email: Matthew[dot]Krummel[at]ucsf[dot]edu)